<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <title>Вхід</title>
  </head>
  <body>
    <h1>Вхід</h1>

    <input id="phone" placeholder="Телефон" />
    <input
      id="password"
      type="password"
      placeholder="Пароль"
    />
    <button onclick="login()">Увійти</button>

    <script>
      async function login() {
        const phone =
          document.getElementById("phone").value;
        const password =
          document.getElementById(
            "password"
          ).value;

        const r = await fetch("/users/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            phone,
            password,
          }),
        });

        const data = await r.json();
        if (data.token) {
          localStorage.setItem(
            "token",
            data.token
          );
          window.location.href =
            "/frontend/messenger.html";
        } else {
          alert("Помилка входу");
        }
      }
    </script>
  </body>
</html>
